<template>
  <div class="container mt-5">
    <div class="d-flex justify-content-between">
      <p class="text-black-50 fst-italic">PF900-05(Rev.0)</p>
      <p class="text-black-50 fst-italic">Certification contract</p>
    </div>
    <div class="mb-5 text-center">
      <h3 class="fw-bold">심 사 계 약 서</h3>

      <hr />
    </div>

    <!-- 계약서 내용 -->
    <p>
      케이에이아이인증원(주)(이하“인증원”이라한다)와 ""주식회사태성진공이엔지""
      (이하“고객”이라한다)는"" { }""
      경영시스템의인증(이하“인증”이라한다)에대하여본계약을체결한다.
    </p>
    <p class="fw-bold">제1조 계약의목적및범위</p>
    <p>
      “인증원”과 “고객”은, “고객”이 “인증원"에게 의뢰한bo
      인증심사(최초,사후관리,변경및갱신심사포함, 이하 ”인증심사“ 라 한다)를
      수행함에 있어 필요한 제반 권리 및 의무사항을 준수하며, ”인증원“이 제공하는
      인증절차안내서는 계약서의 일부로 적용한다.
    </p>
    <p class="fw-bold">제2조 “고객”의 권리와 의무사항</p>
    1.“고객”은 인증원”의 인증절차 안내서를 준수하고, 해당되는 인증표준의
    필수조항에 따라 방침과 목적의 필요조건을 충족 시키며, 해당 경영시스템이
    효과적으로 운영되도록 한다.<br />
    2.“고객”은 인증심사와 관련하여, 필요한 모든 정보를 “인증원”에 제공하여야
    한다.<br />
    3."고객"은 인증등록 후 해당 경영시스템에 중대한 영향을 줄 수 있는 하기의
    사안에 대해 "인증원"에 통보해야 한다.

    <p class="ps-4">
      (1)상호 및 대표자의 변경(소유권 변경 포함)<br />
      (2)경영시스템에 영향을 주는 중대한 조직 및 경영시스템의 변경<br />
      (3)사업장의 증설, 축소 또는 이전<br />
      (4)인증범위의 확대 및 축소<br />
      (5)연락처 및 사업장 주소 변경<br />
      (6)안전보건의 경우, 심각한 사건 발생 또는 해당 규제 당국의 관여가 필요한
      규제위반 발생
    </p>
    <p>
      4.“고객”은 인증제도 운영과 관련하여 인정기관에서 직접 실시하는 입회심사 및
      특별심사 시 현장방문에 동의한다.<br />
      5.“고객”은 인증마크 사용 및 홍보 요령을 준수한다.
    </p>
    <p class="fw-bold">제3조“인증원”의 권리와 의무사항</p>
    <p>
      1.“인증원”은 인증의 승인, 거부, 유지, 갱신, 정지, 복원, 취소 또는
      인증범위의 확대나 취소에 관련된 결정에 책임과 권한을 갖는다. <br />
      2.“인증원”은 다음과 관련된 최신정보를 ‘인증절차안내서’ 및 홈페이지를 통해
      “고객”에게 제공한다. <br />
    </p>
    <p class="ps-3">
      (1)인증심사 및 인증절차<br />
      (2)인증의 신청, 승인, 거부, 유지, 갱신, 정지, 복원, 취소 또는 인증범위의
      확대/취소 기준<br />
      (3)인증심사 비용에 관한 사항<br />
      (4)불만,이의제기 및 분쟁처리 절차<br />
      (5)인증표시 및 로고의 사용방법과 홍보방법
    </p>
    <p>
      3.“인증원”은 공평하고, 편견없는 인증심사를 수행하여야 한다.<br />
      4.“인증원”은 인증 요구사항 변경에 대해 “고객”에 통지하여야 하며, “고객”이
      새로운 요구사항을 준수하는지 검증 하여야 한다.<br />
      5.“인증원”은 “고객”의 인증심사 과정에서 접하게 되는, 기밀사항을 포함한
      “고객”의 모든 정보에 대해 제9조에 따라 기밀을 준수한다.<br />
    </p>
    <p class="fw-bold">제4조 사후관리심사</p>
    <p>
      1.“고객”은 “인증원”의 사후관리 심사 절차에 따라 사후관리 심사를 수검하여야
      한다. 최초인증 이후 1차 사후관리 심사일자는 인증 결정일로부터 12개월을
      초과할 수 없으며, 최소 1회/년 실시해야 한다.<br />
      2.사후관리 심사를 미실시한 경우 인증정지 및 취소될 수 있으며, 인증취소 시
      인증서 원본을 “인증원”에게 반납 하여야 하고, 인증표시 및 로고의 사용과
      홍보를 중지한다.
    </p>
    <p class="fw-bold">제5조 인증에 대한 언급 및 마크의 사용</p>
    <p>
      1.인증마크에 대한 소유권은 “인증원”에 있으며, “고객”은 인증등록이 된
      날로부터 인증마크 및 인증사실을 홍보할 수 있다.<br />
      2.“고객”은 인증에 대한 언급 및 마크의 사용과 관련하여 인터넷, 브로셔나
      광고 또는 기타문서와 같은 전달매체에 표현을 하지 않는다. 또한 인증문서
      또는 인증문서의 일부를 오해가 있는 방식으로 사용해선 안되며, 인증범위가
      축소되는 경우 모든 홍보물을 수정해야 한다. 인증이 인증범위 이외의 활동과
      사업장에 적용됨을 언급해선 안되며, 인증기관 또는 인증시스템의 명예를
      손상시켜 공공의 신뢰를 상실하게 하는 방식으로 인증을 사용하지 않는다.<br />
      3.“고객”은 인증의 취소시, “인증원”의 지시에 따라 인증사실에 대해 언급하고
      있는 모든 홍보물의 사용을 중지한다.<br />
      4.“고객”은 인증마크를 인증마크의 사용에 관한 기준에 따라 사업상의 광고
      또는 홍보물 등에사용할 수 있으나, 제품 또는 소비자가 접하는 제품 포장에는
      사용할 수 없으며, 시험기관의 시험성적서, 교정성적서 또는 검사성적서(이하
      “성적서”라 한다)는 제품인증으로 간주되므로, “고객”은 성적서와 인증마크를
      함께 사용하지 않는다. 단, 경영시스템 인증을 받았다는 문구를 제품포장 등에
      사용할 수 있으며 이 경우 브랜드나 회사명, 경영시스템 유형,인증서
      발행기관명을 포함해야 하며 경영시스템 인증에 대하여 “인증원”이
      제품(서비스포함) 또는 프로세스를 인증한 것으로 언급하지 않는다.<br />
      5.“고객”이 본 계약을 위반하여 발생되는 모든 클레임 및
      피해사항(제3자포함)에 근거하는 손해에 대해 “인증원”에게 직접적인 범위에서
      배상할 의무가 있다.
    </p>
    <p class="fw-bold">제6조 인증범위변경사항보고및변경심사실시</p>
    <p>
      2조3항과 관련하여 “고객”은 “인증원”에게 즉시 서면 또는 구두 통보하고,
      “인증원”은 해당 절차에 따라 특별심사 또는 인증변경 심사를 실시한다.
    </p>
    <p class="fw-bold">제7조 인증효력정지</p>
    <p class="ps-3">
      “고객”이 아래와 같은 사항을 이행하지 않을 경우 인증의 효력이 정지된다.
      <br />
      1.정해진 기한내에 사후관리 심사를 수검하지 않은 경우<br />
      2.인증유지를 위한 심사결과 인증시스템이 적용표준 요구사항을 충족시키기
      위한 자원 및 조직이 없거나 인증시스템이 대부분 가동되지 않는 경우,
      이해관계자로부터 클레임이나 사회적 물의에 의하여 인증시스템에 대한
      신뢰성이 없는 경우<br />
      3.인증제도 및 인증 요구사항의 변경에 대해 대응 조치가 취해지지 않은
      경우<br />
      4.인증심사 결과 중부적합이 발생하여 재확인 심사를 실시 한 결과, 중부적합이
      재발생된 경우<br />
      5.인증마크 오용으로 시정명령을 받은 이후 1개월 이내에 관련 내용이 시정되지
      않을 경우<br />
      6.인증심사비용을 납부하지 않은 경우 또는 고객의 자발적 요청에 의한 경우<br />
      7.본인증계약에 따른 “고객”의 의무사항을 준수하지 않았을 경우<br />
      8.인증서의 적용범위를 초과하여 사용한 경우<br />
      9.인증신청 및 심사 중 제공된 정보나 문서가 허위로 판명된 경우<br />
      10.“고객”의 중대한 변경사항 통보가 이행되지 아니하여 인증효력에 문제가
      발생한 경우<br />
      11.“인증원”과의 계약 또는 합의사항을 위반한 경우<br />
      12.제2조 3(6)항에 따라 실시된 특별심사결과, 시스템의 심각한 실패가 실증된
      경우<br />
    </p>
    <p class="fw-bold">제8조 인증취소</p>

    <p>
      “고객”이 다음 사항을 이행하지 않을 경우 인증이 취소된다.<br />
      1.인증효력 정지처분에도 불구하고 3개월이 지나도록 시정조치가 이루어지지
      않을 경우<br />
      2.“고객”이 공식적으로 인증서를 반납하는 경우<br />
      3.인증범위에 포함된 제품(공정)의 생산활동이나 서비스가 중단된 경우<br />
      4.“고객”의 파산, 연락두절 등으로 인증 대상조직의 실체가 없어지거나
      확인되지 않은 경우<br />
      5.인증서 유효기간 내에 인증효력이 3회 이상 정지된 경우<br />
      6.인증서 회수요청 접수후 1개월을 초과하여 불응한 경우<br />
      7.제7조 12항에 따라 효력정지후 기한내에 시정조치가 완료되지 않은 경우<br />
    </p>
    <p class="fw-bold">제9조 기밀유지</p>
    <p>
      “인증원”은 인증의 심사중 취득한 “고객”의 어떠한 정보도 인정기관
      요구사항에서 요구되는 경우를 제외하고는 인증등록조직목록 이외의 특정
      제품이나 “고객”에 대한 기밀정보를 “고객”의 서면동의 없이 제3자에게
      제공하지 않는다.<br />
      단 법률에 따라 제3자에게 “인증원”이 “고객”의 정보를 공개하였을 경우 해당
      정보를 공개하였음을 “고객”에게 통보 해야한다. <br />단 다음의 경우에는
      이러한 구속을 받지않는다. <br />1.“고객”으로부터 “인증원”에게 제공되기
      전에 “인증원”이 가지고 있었던 정보 또는 합법적으로 일반에게 알려져 있는
      정보<br />
      2.“고객”과 무관한 출처로부터 “인증원”이 합법적으로 얻은 정보<br />
      3.인정기관의 지정심사와 관련하여 인정기관으로부터 요구된 정보
    </p>
    <p class="fw-bold">제10조 이의,불만및분쟁</p>
    <p>
      “고객”은 인증심사 및 인증과 관련하여 이의, 불만, 분쟁사항이 있을 경우
      “인증원”에게 서면으로 해당 사항을 통보하여야 한다. “인증원”은 이의, 불만,
      분쟁사항에 대해서 내부절차에 따라 처리하고 그 결과를 “고객”에게 서면 통보
      해야한다.
    </p>
    <p class="fw-bold">제11조 심사비용</p>
    <p>
      1.심사비용은 “인증원”의 청구서 내용으로 하며, “고객”은 심사시작일 7일 전에
      결제한다.<br />
      2.심사에 따른 “인증원”의 출장비, 숙박비 등 의경비는 “고객”이 부담한다.<br />
      3.“고객”의 인증변경신청시 특별심사가 요구되는 경우 심사비용은 별도
      청구된다.<br />
    </p>
    <p class="fw-bold">제12조 배상책임</p>
    <p>
      1.“인증원”은 업무상 과실로 인한 “고객”의 손해를 배상할 책임이 있다.
      “인증원”의 인증 수행범위의 일부 또는 전부에 대해 인정의 취소가 결정되는
      경우 “고객”에 대한 배상 및 타인증 기관으로 이관하기 위한 법적 준비를
      갖추어야 한다. 배상액은 "인증원“이 가입한 배상책임보험 조건에 따르며,
      간접적 이거나 결과적으로 인한 손실은 여기에 포함되지 않는다.<br />
      2.“고객”은 제3자의 이해관계에 따라 제기되는 피해를 포함하여, 본 계약에
      따라 “고객”에게 부여된 인증등록에 대한 오용결과로 제기된 피해에 대하여
      보상할 책임이 있다.
    </p>
    <p class="fw-bold">제13조 불가항력</p>
    <p>
      본 계약이 전쟁, 천재지변, 전염병, 태업, 공장폐쇄와 그 외의 다른 통상의
      능력을 초과하는 것으로 고려되는 원인에 의해 자신의 의무를 수행하지 못할
      경우는 상대방에 대하여 해당 불이행에 근거한 책임을 지지 않는 것으로 한다.
    </p>
    <p class="fw-bold">제14조 계약서의 해석 및 분쟁 해결</p>
    <p>
      본 계약에 명시되지 않은 사항 및 계약서의 해석상 이의가 있을 경우에는
      상호협의하여 합의결정하도록 최대한 노력하고 그렇지 못할 경우 통상 관례에
      따르며, 만약 소송 발생시 분쟁의 해결은 “인증원”이 소재하고 있는 관할
      법원으로 한다.
    </p>
    <p class="fw-bold">제15조 계약기간 및 계약동의</p>
    <p>
      본 계약의 계약기간은 계약일로부터 인증이 유지되는 기간 동안 그 효력이
      지속되며, 계약서 2부를 작성하여 “인증원” 과 “고객”이 1부씩 보관한다.
    </p>
    2022년10월08일 갑: 케이에이아이인증원(주) 을: 주식회사태성진공이엔지
    대표이사 박성훈 (인)또는(서명) 대표이사 김성태 (인)또는(서명)

    <div class="text-end mt-5">
      <button type="button" class="btn btn-primary" @click="doSave">
        저장
      </button>
      <button type="button" class="btn btn-secondary ms-2">취소</button>
    </div>
  </div>
</template>

<script>
export default {
  computed: {
    user() {
      const data = this.$store.state.user
      console.log(data)
      console.log(data.userInfo.name, data.userInfo.email)
      return data

      // return this.$store.state.user.user
      // return this.$store.user.userInfo
    }
  },
  components: {},
  data() {
    return {
      id: '',
      // searchName: '',
      imgSrc: '',
      imgExt: '',
      rows: [
        {
          start_h: '',
          start_m: '',
          end_h: '',
          end_m: '',
          leader: '',
          auditor: ''
        }
      ],
      auditTeam: {
        leader: '',
        auditor1: '',
        auditor2: '',
        auditor3: ''
      },
      companions: {
        tech_expert: '',
        trainee1: '',
        trainee2: '',
        trainee3: ''
      },
      checkpoint: {
        biz_area: '',
        reliability: '',
        issue: '',
        biz_status: '',
        needs: '',
        scope: '',
        quality_risk: '',
        env_risk: '',
        safety_risk: '',
        regal: '',
        policy: '',
        goal: '',
        internal_audit: '',
        management_review: '',
        understanding_level: '',
        workspace: '',
        exclusion: '',
        worker_count: '',
        s2md: '',
        guider: '',
        place: '',
        precautions: '',
        site_address: '',
        visit_time: '',
        contact: ''
        // findings: {},
        // findings_content: {},
        // findings_standard: {}
        // findings_array: []
      }
    }
  },
  created() {},
  mounted() {
    // console.log(this.user.userInfo.email)
    if (this.user.userInfo.email === undefined) {
      alert('로그인이 필요합니다.')
      this.$router.push({ path: '/login' })
    }
  },
  unmounted() {},
  methods: {
    showRequirement() {
      window.open()
    },
    addRow() {
      this.rows.push({
        start_h: '',
        start_m: '',
        end_h: '',
        end_m: '',
        leader: '',
        auditor: ''
      })
    },
    removeRow() {
      this.rows.pop()
    },
    execDaumPostcode() {
      // @click을 사용할 때 함수는 이렇게 작성해야 한다.
      new window.daum.Postcode({
        oncomplete: (data) => {
          console.log(data)
          if (this.customer.address_extra !== '') {
            this.customer.address_extra = ''
          }
          if (data.userSelectedType === 'R') {
            // 사용자가 도로명 주소를 선택했을 경우
            this.customer.address_ko = data.roadAddress
          } else {
            // 사용자가 지번 주소를 선택했을 경우(J)
            this.customer.address_ko = data.jibunAddress
          }

          // 사용자가 선택한 주소가 도로명 타입일때 참고항목을 조합한다.
          if (data.userSelectedType === 'R') {
            // 법정동명이 있을 경우 추가한다. (법정리는 제외)
            // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
            if (data.bname !== '' && /[동|로|가]$/g.test(data.bname)) {
              this.customer.address_reference += data.bname
            }
            // 건물명이 있고, 공동주택일 경우 추가한다.
            if (data.buildingName !== '' && data.apartment === 'Y') {
              this.customer.address_reference +=
                this.customer.address_reference !== ''
                  ? `, ${data.buildingName}`
                  : data.buildingName
            }
            // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
            if (this.customer.address_detail !== '') {
              this.customer.address_detail = `(${this.customer.address_detail})`
            }
          } else {
            this.customer.address_reference = ''
          }

          // 영문주소
          this.customer.address_en = data.addressEnglish

          // 우편번호를 입력한다.
          this.customer.postcode = data.zonecode
        }
      }).open()
    },
    async uploadFile(files) {
      const r = await this.$upload('/api/upload/file', files[0])
      console.log(r)
      this.imgSrc = `http://localhost:3000/static/uploads/${r.filename}`
      this.customer.img_license = r.filename
      this.customer.img_license_originalname = r.originalname
      this.imgExt = r.mimetype
      console.log(this.customer.img_license)
      console.log(this.customer.img_license_originalname)
      console.log(this.imgExt)
    },
    async doSave() {
      // if (this.customer.certification_type === '') {
      //   return this.$swal('인증유형을 선택해주세요.')
      // }
      // if (this.customer.name_ko === '') {
      //   return this.$swal('국문회사명을 입력하세요.')
      // }
      // if (this.customer.name_en === '') {
      //   return this.$swal('영문회사명을 입력하세요.')
      // }
      // if (this.customer.business_no === '') {
      //   return this.$swal('사업자등록번호를 입력하세요.')
      // }
      // if (this.customer.ceo_name === '') {
      //   return this.$swal('대표자명을 입력하세요.')
      // }
      // if (this.customer.email === '') {
      //   return this.$swal('대표이메일을 입력하세요.')
      // }
      // if (this.customer.phone === '') {
      //   return this.$swal('대표전화번호를 입력하세요.')
      // }
      // if (this.customer.address_ko === '') {
      //   return this.$swal('주소를 입력하세요.')
      // }
      // if (this.customer.contact_name === '') {
      //   return this.$swal('자명/직위를 입력하세요.')
      // }
      // if (this.customer.contact_phone === '') {
      //   return this.$swal('자 연락처를 입력하세요.')
      // }
      // if (this.customer.contact_email === '') {
      //   return this.$swal('자 이메일을 입력하세요.')
      // }
      // if (this.customer.organization_scope === '') {
      //   return this.$swal('조직의 범위를 입력하세요.')
      // }
      // if (this.customer.certification_standard === '') {
      //   return this.$swal('신청 인증표준을 입력하세요.')
      // }
      // if (this.customer.design === '') {
      //   return this.$swal('설계/개발 유무를 입력하세요.')
      // }
      // if (this.customer.scope_ko === '') {
      //   return this.$swal('국문 인증범위를 입력하세요.')
      // }

      this.$swal({
        title: '보고서를 생성 하시겠습니까?',
        // text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        cancelButtonText: '취소',
        confirmButtonText: '저장'
      }).then(async (result) => {
        if (result.isConfirmed) {
          const loader = this.$loading.show({ canCancel: false })

          const r = await this.$post('/api/report/s1', {
            param: {
              leader: this.auditTeam.leader,
              auditor1: this.auditTeam.auditor1,
              auditor2: this.auditTeam.auditor2,
              auditor3: this.auditTeam.auditor3,
              tech_expert: this.companions.tech_expert,
              trainee1: this.companions.trainee1,
              trainee2: this.companions.trainee2,
              trainee3: this.companions.trainee3,
              biz_area: this.checkpoint.biz_area,
              reliability: this.checkpoint.reliability,
              issue: this.checkpoint.issue,
              biz_status: this.checkpoint.biz_status,
              needs: this.checkpoint.needs,
              scope: this.checkpoint.scope,
              quality_risk: this.checkpoint.quality_risk,
              env_risk: this.checkpoint.env_risk,
              safety_risk: this.checkpoint.safety_risk,
              regal: this.checkpoint.regal,
              policy: this.checkpoint.policy,
              goal: this.checkpoint.goal,
              internal_audit: this.checkpoint.internal_audit,
              management_review: this.checkpoint.management_review,
              understanding_level: this.checkpoint.understanding_level,
              workspace: this.checkpoint.workspace,
              exclusion: this.checkpoint.exclusion,
              worker_count: this.checkpoint.worker_count,
              s2md: this.checkpoint.s2md,
              guider: this.checkpoint.guider,
              place: this.checkpoint.place,
              precautions: this.checkpoint.precautions,
              site_address: this.checkpoint.site_address,
              visit_time: this.checkpoint.visit_time,
              contact: this.checkpoint.contact,
              findings_array: JSON.stringify(this.rows)
              // findings: JSON.stringify(this.row.findings),
              // findings_content: JSON.stringify(this.row.findings_content),
              // findings_standard: JSON.stringify(this.row.findings_standard)
            }
          })

          loader.hide()

          console.log(r)

          if (r.status === 200) {
            this.$swal('1단계 심사보고서가 저장되었습니다.')
            this.$router.push({
              path: '/customer/list',
              query: { customer_id: r.data.insertId }
            })
          }
        }
      })
    },
    goToList() {
      this.$router.push({ path: '/customer/list' })
    }
  }
}
</script>
<style scoped>
textarea {
  font-size: 14px;
}
table {
  font-size: 14px;
}
</style>
